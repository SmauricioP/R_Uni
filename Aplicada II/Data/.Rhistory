library(tidyverse)
library(corrplot)
library(ResourceSelection)
library(ROCR)
library(ResourceSelection)
library(ROCR)
setwd("C:/Users/Mauca/Desktop/R/Data")
setwd("~/Statistics/R docs/Data")
data <- read.csv("dataR2.csv")
data$Classification = data$Classification - 1
summary(data)
logistic1 <- glm(Classification ~ Glucose, family = "binomial", data) #Model
summary(logistic1) #Summary of model
df1 <- data.frame(data, prob = logistic1$fitted.values)
ggplot(df1) +
geom_point(aes(x =Glucose, Classification), color = "red", size = 1.5) +
geom_point(aes(x =Glucose, prob), color ="blue", size = 1.5) +
geom_segment(aes(x= Glucose, y = Classification,
xend = Glucose, yend = prob), linetype = 2,
color = "black", alpha = 1/4) +
geom_smooth(aes(x =Glucose, y = Classification), method = "glm",
method.args = list(family = "binomial"), formula = y ~ x, se = F,
color = "black", size = 1, linetype = 2) +
theme_bw()
result1 <- ifelse(df1$prob > 0.5,1,0)
(acc1 <- mean(ifelse(result1 == df1$Classification, 1,0)))*100 #Accuracy
result1
library(caret)
confusionMatrix(result1,data$Classification)
data$Classification
result1
str(data$Classification)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.0,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.1,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.2,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.3,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.4,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.5,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.6,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.7,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.4,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.5,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.3,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.6,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.7,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.8,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
result1 <- ifelse(df1$prob > 0.9,1,0)
confusionMatrix(factor(result1, levels = c(0,1)),factor(data$Classification, levels = c(0,1)))
